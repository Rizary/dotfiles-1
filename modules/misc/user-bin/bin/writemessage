#!/bin/sh

message=$1
program="$2"

writemessage() {
    if [ -f $XDG_RUNTIME_DIR/message ]; then
        echo "$message" >> $XDG_RUNTIME_DIR/message
    else
        echo "$message" > $XDG_RUNTIME_DIR/message
    fi
}

writemessage
messageId=$(wc -l $XDG_RUNTIME_DIR/message | cut -d ' ' -f 1)

clear() {
    clearmessage $messageId
}

if [ "$program" ]; then
    trap clear EXIT
fi

if [ "$program" ]; then
    bash -c "$2"
else
    echo $messageId
fi
